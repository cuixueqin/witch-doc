# Energy module

WITCH includes a comprehensive range of technology options to
describe the final use of energy and the generation of electricity.
The energy sector is described by a production function that aggregates
different factors at various levels and with associated elasticities of substitution $\rho$.
The main distinction is among electric generation and non-electric
consumption of energy. 

All the main technology features are represented:
yearly utilisation factors, fuel efficiencies, investment, and
operation and maintenance costs.

## Electric energy technology sectors

Electricity is generated by a series of traditional fossil fuel-based
technologies and carbon-free options.
Fossil fuel-based technologies include natural gas combined cycle (NGCC),
fuel oil and pulverised coal (PC) power plants.
Coal-based electricity can also be generated using IGCC production with CCS.
Low carbon technologies include hydroelectric and nuclear power,
renewable sources such as wind turbines and photovoltaic panels (wind and solar)
and two breakthrough technologies. 

The cost of electricity generation is endogenous and it combines capital costs,
O&M expenditure and the expenditure for fuels.

### Capital accumulation for electric energy technology sectors

The capital of some electricity production technologies accumulates as follows:
$$
   K_j(t+1,n) = K_j(t,n)\left(1-\delta_j(t+1,n)\right)^{\Delta_t} +
                \Delta_t \times \frac{I_j(t,n)}{SC_j(t,n)}, \forall j\in \mathcal{J}_{inv},
$$
where $\mathcal{J}_{inv}$ is the set of electric energy technology sectors in which one can invest.
The investment cost $SC$  for solar and wind energy is 
decreasing with the world cumulative installed capacity by means of
Learning-by-Doing.
On the other hand the investment costs $SC$  for backstop technologies are computed using Two Factor Learning Curve: costs reductions are driven by both, growth in cumulated installed capacity and accumulation of R&D knowledge.

The aforementioned methodology is shown in [Research and Development](mod_knowledge)

```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 39:42,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Capital accumulation symbolic terms'
)
```

### Production in electric sector

The CES top-tree for the electricity production sector is 
defined by the three following equations:

$$
    EL(t,n) = EL2(t,n) + \alpha_{el_{hydro}}(n) EL_{hydro}(t,n)
$$

$$
    EL2(t,n) = \phi_{el2}(n) \left( 
                           \alpha_{el2}(n) ELFF(t,n)^{\rho_{el2}(n)} +
                           \beta_{el2}(n) EL_{nucback}(t,n)^{\rho_{el2}(n)} +
                           \gamma_{el2}(n) EL_{intren}(t,n)^{\rho_{el2}(n)}
                           \right)^{\frac{1}{\rho_{el2}}(n)}
$$

$$
    ELFF(t,n) = \phi_{elff}(n) \left( 
                           \alpha_{elff}(n) EL_{coalwbio}(t,n)^{\rho_{elff}(n)} +
                           \beta_{elff}(n) EL_{oil}(t,n)^{\rho_{elff}(n)} +
                           \gamma_{elff}(n) EL_{gas}(t,n)^{\rho_{elff}(n)}
                           \right)^{\frac{1}{\rho_{elff}}(n)}
$$

```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 43:51,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Electric production symbolic terms'
)
```

## Non-electric energy technology sectors

Energy consumption in the non-electric sector is based on traditional fuels
(traditional biomass, oil, gas and coal) and bio-fuels.
In order to account for food security concerns, overall penetration of
bio-fuels is assumed to remain modest over the century.
The consumption of oil can be substituted with a carbon-free backstop
technology, which could be thought of as next generation bio-fuels or
carbon-free hydrogen.
As a consequence, the backstop technology is mostly conceived as an
abatement option for the transport sector. 

### Production in the non-electric sector

The CES tree for the non-electric energy technology sector is 
defined by the two following equations:

$$
    NEL(t,n) = \alpha_{nel_{coal}} NEL_{coal}(t,n) +
             NEL_{log}(t,n) +
             \alpha_{nel_{trbiomass}} NEL_{trbiomass}(t,n) 
$$

$$
    NEL_{log}(t,n) = \phi_{nelog}(n) \left( 
                           \alpha_{nelog}(n) NEL_{oilback}(t,n)^{\rho_{nelog}(n)} +
                           \beta_{nelog}(n) NEL_{gas}(t,n)^{\rho_{nelog}(n)} +
                           \gamma_{nelog}(n) NEL_{trbiofuel}(t,n)^{\rho_{nelog}(n)}
                           \right)^{\frac{1}{\rho_{nelog}}(n)}
$$

```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 52:58,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Electric production symbolic terms'
)
```

## Primary Energy Supply

The total primary energy supply is the sum of the consumption from all the sectors.  

$$
    Q_f(t,n) = \sum_j Q_{j,f}(t,n)
$$


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 59:60,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'PES symbolic terms'
)
```

## Trade balance of energy

The consumption of fuel $f$, $Q_f$, and
either domestic extraction or imports,
$X_{f}$ are balanced at the world level. 

$$
    \sum_n Q_f(t,n) = \sum_n X_f(t,n)
$$


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 61:62,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Energy balance symbolic terms'
)
```

 1.  If the country is a net exporter, $X_f$ is negative.
 2.  In the current version, the fuel trades happen only for oil.

## Fuel cost

The net cost of Primary Energy Supplies (PES) is equal to the
cost of consumed fuels minus the cost of extracted fuels

$$
	C_f(t,n) = MC_f(t,n) \times Q_f(t,n) -
	              p_f(t) \times X_f(t,n)
$$


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 63:67,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Fuel cost symbolic terms'
)
```

The price of fossil fuels and exhaustible resources (oil, gas, coal and
uranium) is determined by the marginal cost of
extraction, which in turn depends on current and cumulative
extraction, plus a regional mark-up to mimic different regional costs.

## Additional constraints

### Constraint on the electric production capacity

In the electric sector, the production capacity is bounded by the capital stock adjusted by the coefficient $\mu$ (**mu**).

$$
    EL_j(t,n) \le \mu_j(t,n) \times KEL_j(t,n)
$$


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 68:70,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Electric poduction capacity symbolic terms'
)
```

### Constraint on new capacity of electric backstop

Breakthrough in power generation technologies is modelled by introducing
a backstop technology, that can be better thought of as a compact
representation of a portfolio of advanced technologies that can
substitute nuclear power.

The share of new production capacity of the technology "Electric backstop" is bounded by the coefficient **lim_elback** = 5%. 

$$
       EL_{elback}(t+1,n) - EL_{elback}(t,n) \le lim\_elback \times \left( EL(t,n) - EL_{elback}(t,n) \right)
$$


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 71:72,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Electric backstop symbolic terms'
)
```

## Efficiency of the energy technology sectors

The production capacity is equal to the energy consumed times the overall efficiency ratio of the sector $\xi$ (**csi**).

$$
    Q_j(t,n) = \sum_f \xi_{j,f}(t,n) \times Q_{j,f}(t,n)
$$


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 73:75,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Efficiency related symbolic terms'
)
```


## Energy tree

Ensure that the production capacity are consistent at each levels of the energy tree.

$$
    Q_j(t,n) = \sum_{j'\in succ(j)} Q_{j'}(t,n),
$$
where $succ(j)$ are the successors of $j$ in the energy tree.


```{r, echo=F}
library(data.table)
sym_witch = fread("symbols.csv",sep=",",header=T)
tab = sym_witch[id %in% 73:75,.(Symbol,Definition,GAMS,Unit)]
knitr::kable(
tab, booktabs = TRUE,
caption = 'Energy tree related symbolic terms'
)
```
